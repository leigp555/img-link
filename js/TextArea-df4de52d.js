import{m as e,h as t,l as a,a as n,b as o,u as l,r as i,_ as r}from"./default-542f2d13.js";import{t as u,a as s,C as v,b as c,r as d,f as p}from"./index-7b36b708.js";import{o as f,R as g,u as m}from"./index-f9d4b565.js";import{d as h,e as x,M as b,f as z,n as y,g as w,a as A,K as S,J as C,b as E,H as T}from"./index-c9e87c00.js";var V,M="\n min-height:0 !important;\n max-height:none !important;\n height:0 !important;\n visibility:hidden !important;\n overflow:hidden !important;\n position:absolute !important;\n z-index:-1000 !important;\n top:0 !important;\n right:0 !important\n",P=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break"],R={};function j(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&R[a])return R[a];var n=window.getComputedStyle(e),o=n.getPropertyValue("box-sizing")||n.getPropertyValue("-moz-box-sizing")||n.getPropertyValue("-webkit-box-sizing"),l=parseFloat(n.getPropertyValue("padding-bottom"))+parseFloat(n.getPropertyValue("padding-top")),i=parseFloat(n.getPropertyValue("border-bottom-width"))+parseFloat(n.getPropertyValue("border-top-width")),r=P.map((function(e){return"".concat(e,":").concat(n.getPropertyValue(e))})).join(";"),u={sizingStyle:r,paddingSize:l,borderSize:i,boxSizing:o};return t&&a&&(R[a]=u),u}var F=h({compatConfig:{MODE:3},name:"ResizableTextArea",inheritAttrs:!1,props:u(),setup:function(l,i){var r,u,v=i.attrs,c=i.emit,d=i.expose,p=x(),m=x({}),h=x(0);b((function(){e.cancel(r),e.cancel(u)}));var E=function(){var t=l.autoSize||l.autosize;if(t&&p.value){var a=t.minRows,n=t.maxRows;m.value=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;V||((V=document.createElement("textarea")).setAttribute("tab-index","-1"),V.setAttribute("aria-hidden","true"),document.body.appendChild(V)),e.getAttribute("wrap")?V.setAttribute("wrap",e.getAttribute("wrap")):V.removeAttribute("wrap");var o=j(e,t),l=o.paddingSize,i=o.borderSize,r=o.boxSizing,u=o.sizingStyle;V.setAttribute("style","".concat(u,";").concat(M)),V.value=e.value||e.placeholder||"";var s,v=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,d=V.scrollHeight;if("border-box"===r?d+=i:"content-box"===r&&(d-=l),null!==a||null!==n){V.value=" ";var p=V.scrollHeight-l;null!==a&&(v=p*a,"border-box"===r&&(v=v+l+i),d=Math.max(v,d)),null!==n&&(c=p*n,"border-box"===r&&(c=c+l+i),s=d>c?"":"hidden",d=Math.min(c,d))}return{height:"".concat(d,"px"),minHeight:"".concat(v,"px"),maxHeight:"".concat(c,"px"),overflowY:s,resize:"none"}}(p.value,!1,a,n),h.value=1,e.cancel(u),u=e((function(){h.value=2,u=e((function(){h.value=0,function(){try{if(document.activeElement===p.value){var e=p.value.selectionStart,t=p.value.selectionEnd;p.value.setSelectionRange(e,t)}}catch(a){}}()}))}))}},T=function(t){0===h.value&&(c("resize",t),(l.autoSize||l.autosize)&&(e.cancel(r),r=e(E)))};t(void 0===l.autosize,"Input.TextArea","autosize is deprecated, please use autoSize instead.");z((function(){return l.value}),(function(){y((function(){E()}))})),w((function(){y((function(){E()}))}));var P=C();return d({resizeTextarea:E,textArea:p,instance:P}),function(){return e=l.prefixCls,t=l.autoSize,i=l.autosize,r=l.disabled,u=f(l,["prefixCls","onPressEnter","autoSize","autosize","defaultValue","allowClear","type","lazy","maxlength","valueModifiers"]),c=a(e,v.class,n({},"".concat(e,"-disabled"),r)),d=[v.style,m.value,1===h.value?{overflowX:"hidden",overflowY:"hidden"}:null],(x=o(o(o({},u),v),{},{style:d,class:c})).autofocus||delete x.autofocus,0===x.rows&&delete x.rows,A(g,{onResize:T,disabled:!(t||i)},{default:function(){return[S(A("textarea",o(o({},x),{},{ref:p}),null),[[s]])]}});var e,t,i,r,u,c,d,x}}});function I(e,t){return i(e||"").slice(0,t).join("")}function N(e,t,a,n){var o=a;return e?o=I(a,n):i(t||"").length<a.length&&i(a||"").length>n&&(o=t),o}var H=h({compatConfig:{MODE:3},name:"ATextarea",inheritAttrs:!1,props:u(),setup:function(e,t){var u=t.attrs,s=t.expose,g=t.emit,h=m(),b=x(void 0===e.value?e.defaultValue:e.value),w=x(),S=x(""),V=l("input",e),M=V.prefixCls,P=V.size,R=V.direction,j=E((function(){return""===e.showCount||e.showCount||!1})),H=E((function(){return Number(e.maxlength)>0})),_=x(!1),k=x(),B=x(0),D=function(e){_.value=!0,k.value=S.value,B.value=e.currentTarget.selectionStart,g("compositionstart",e)},G=function(t){_.value=!1;var a,n=t.currentTarget.value;H.value&&(n=N(B.value>=e.maxlength+1||B.value===(null===(a=k.value)||void 0===a?void 0:a.length),k.value,n,e.maxlength));n!==S.value&&(X(n),d(t.currentTarget,t,q,n)),g("compositionend",t)},K=C();z((function(){return e.value}),(function(){var t;K.vnode.props,b.value=null!==(t=e.value)&&void 0!==t?t:""}));var O=function(e){var t;c(null===(t=w.value)||void 0===t?void 0:t.textArea,e)},X=function(t,a){b.value!==t&&(void 0===e.value?b.value=t:y((function(){var e,t,a;w.value.textArea.value!==S.value&&(null===(e=w.value)||void 0===e||null===(t=(a=e.instance).update)||void 0===t||t.call(a))})),y((function(){a&&a()})))},Y=function(e){13===e.keyCode&&g("pressEnter",e),g("keydown",e)},J=function(t){var a=e.onBlur;null==a||a(t),h.onFieldBlur()},q=function(e){g("update:value",e.target.value),g("change",e),g("input",e),h.onFieldChange()},L=function(e){d(w.value.textArea,e,q),X("",(function(){O()}))},Q=function(t){var a=t.target.composing,n=t.target.value;if(_.value=!(!t.isComposing&&!a),!(_.value&&e.lazy||b.value===n)){if(H.value){var o=t.target;n=N(o.selectionStart>=e.maxlength+1||o.selectionStart===n.length||!o.selectionStart,S.value,n,e.maxlength)}d(t.currentTarget,t,q,n),X(n)}},U=function(){var t,a,l,i=u.style,r=u.class,s=e.bordered,v=void 0===s||s,c=o(o(o({},f(e,["allowClear"])),u),{},{style:j.value?{}:i,class:(t={},n(t,"".concat(M.value,"-borderless"),!v),n(t,"".concat(r),r&&!j.value),n(t,"".concat(M.value,"-sm"),"small"===P.value),n(t,"".concat(M.value,"-lg"),"large"===P.value),t),showCount:null,prefixCls:M.value,onInput:Q,onChange:Q,onBlur:J,onKeydown:Y,onCompositionstart:D,onCompositionend:G});return null!==(a=e.valueModifiers)&&void 0!==a&&a.lazy&&delete c.onInput,A(F,o(o({},c),{},{id:null!==(l=c.id)&&void 0!==l?l:h.id.value,ref:w,maxlength:e.maxlength}),null)};return s({focus:O,blur:function(){var e,t;null===(e=w.value)||void 0===e||null===(t=e.textArea)||void 0===t||t.blur()},resizableTextArea:w}),T((function(){var t=p(b.value);_.value||!H.value||null!==e.value&&void 0!==e.value||(t=I(t,e.maxlength)),S.value=t})),function(){var t=e.maxlength,l=e.bordered,s=void 0===l||l,c=e.hidden,d=u.style,p=u.class,f=o(o(o({},e),u),{},{prefixCls:M.value,inputType:"text",handleReset:L,direction:R.value,bordered:s,style:j.value?void 0:d}),g=A(v,o(o({},f),{},{value:S.value}),{element:U});if(j.value){var m=i(S.value).length,h="";h="object"===r(j.value)?j.value.formatter({count:m,maxlength:t}):"".concat(m).concat(H.value?" / ".concat(t):""),g=A("div",{hidden:c,class:a("".concat(M.value,"-textarea"),n({},"".concat(M.value,"-textarea-rtl"),"rtl"===R.value),"".concat(M.value,"-textarea-show-count"),p),style:d,"data-count":"object"!==r(h)?h:void 0},[g])}return g}}});export{H as T};
