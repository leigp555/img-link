import{j as e,e as t,h as a,a as n,b as o,u as l,o as i,_ as r}from"./default-37a9e99b.js";import{t as u,a as s,C as v,b as c,r as d,f as p}from"./index-06df1089.js";import{R as f}from"./index-6ef490d3.js";import{o as g,u as m}from"./FormItemContext-0fd4b304.js";import{d as h,b as x,K as b,f as z,n as y,g as w,a as A,I as C,P as S,e as E,H as T}from"./index-44b8c168.js";var j,P="\n min-height:0 !important;\n max-height:none !important;\n height:0 !important;\n visibility:hidden !important;\n overflow:hidden !important;\n position:absolute !important;\n z-index:-1000 !important;\n top:0 !important;\n right:0 !important\n",V=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break"],F={};function R(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&F[a])return F[a];var n=window.getComputedStyle(e),o=n.getPropertyValue("box-sizing")||n.getPropertyValue("-moz-box-sizing")||n.getPropertyValue("-webkit-box-sizing"),l=parseFloat(n.getPropertyValue("padding-bottom"))+parseFloat(n.getPropertyValue("padding-top")),i=parseFloat(n.getPropertyValue("border-bottom-width"))+parseFloat(n.getPropertyValue("border-top-width")),r=V.map((function(e){return"".concat(e,":").concat(n.getPropertyValue(e))})).join(";"),u={sizingStyle:r,paddingSize:l,borderSize:i,boxSizing:o};return t&&a&&(F[a]=u),u}const I=h({compatConfig:{MODE:3},name:"ResizableTextArea",inheritAttrs:!1,props:u(),setup:function(l,i){var r,u,v=i.attrs,c=i.emit,d=i.expose,p=x(),m=x({}),h=x(0);b((function(){e.cancel(r),e.cancel(u)}));var E=function(){var t=l.autoSize||l.autosize;if(t&&p.value){var a=t.minRows,n=t.maxRows;m.value=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;j||((j=document.createElement("textarea")).setAttribute("tab-index","-1"),j.setAttribute("aria-hidden","true"),document.body.appendChild(j)),e.getAttribute("wrap")?j.setAttribute("wrap",e.getAttribute("wrap")):j.removeAttribute("wrap");var o=R(e,t),l=o.paddingSize,i=o.borderSize,r=o.boxSizing,u=o.sizingStyle;j.setAttribute("style","".concat(u,";").concat(P)),j.value=e.value||e.placeholder||"";var s,v=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,d=j.scrollHeight;if("border-box"===r?d+=i:"content-box"===r&&(d-=l),null!==a||null!==n){j.value=" ";var p=j.scrollHeight-l;null!==a&&(v=p*a,"border-box"===r&&(v=v+l+i),d=Math.max(v,d)),null!==n&&(c=p*n,"border-box"===r&&(c=c+l+i),s=d>c?"":"hidden",d=Math.min(c,d))}return{height:"".concat(d,"px"),minHeight:"".concat(v,"px"),maxHeight:"".concat(c,"px"),overflowY:s,resize:"none"}}(p.value,!1,a,n),h.value=1,e.cancel(u),u=e((function(){h.value=2,u=e((function(){h.value=0,function(){try{if(document.activeElement===p.value){var e=p.value.selectionStart,t=p.value.selectionEnd;p.value.setSelectionRange(e,t)}}catch(a){}}()}))}))}},T=function(t){0===h.value&&(c("resize",t),(l.autoSize||l.autosize)&&(e.cancel(r),r=e(E)))};t(void 0===l.autosize,"Input.TextArea","autosize is deprecated, please use autoSize instead.");z((function(){return l.value}),(function(){y((function(){E()}))})),w((function(){y((function(){E()}))}));var V=S();return d({resizeTextarea:E,textArea:p,instance:V}),function(){return e=l.prefixCls,t=l.autoSize,i=l.autosize,r=l.disabled,u=g(l,["prefixCls","onPressEnter","autoSize","autosize","defaultValue","allowClear","type","lazy","maxlength","valueModifiers"]),c=a(e,v.class,n({},"".concat(e,"-disabled"),r)),d=[v.style,m.value,1===h.value?{overflowX:"hidden",overflowY:"hidden"}:null],(x=o(o(o({},u),v),{},{style:d,class:c})).autofocus||delete x.autofocus,0===x.rows&&delete x.rows,A(f,{onResize:T,disabled:!(t||i)},{default:function(){return[C(A("textarea",o(o({},x),{},{ref:p}),null),[[s]])]}});var e,t,i,r,u,c,d,x}}});function M(e,t){return i(e||"").slice(0,t).join("")}function N(e,t,a,n){var o=a;return e?o=M(a,n):i(t||"").length<a.length&&i(a||"").length>n&&(o=t),o}const H=h({compatConfig:{MODE:3},name:"ATextarea",inheritAttrs:!1,props:u(),setup:function(e,t){var u=t.attrs,s=t.expose,f=t.emit,h=m(),b=x(void 0===e.value?e.defaultValue:e.value),w=x(),C=x(""),j=l("input",e),P=j.prefixCls,V=j.size,F=j.direction,R=E((function(){return""===e.showCount||e.showCount||!1})),H=E((function(){return Number(e.maxlength)>0})),_=x(!1),k=x(),B=x(0),D=function(e){_.value=!0,k.value=C.value,B.value=e.currentTarget.selectionStart,f("compositionstart",e)},G=function(t){_.value=!1;var a,n=t.currentTarget.value;H.value&&(n=N(B.value>=e.maxlength+1||B.value===(null===(a=k.value)||void 0===a?void 0:a.length),k.value,n,e.maxlength));n!==C.value&&(X(n),d(t.currentTarget,t,J,n)),f("compositionend",t)},K=S();z((function(){return e.value}),(function(){var t;K.vnode.props,b.value=null!==(t=e.value)&&void 0!==t?t:""}));var O=function(e){var t;c(null===(t=w.value)||void 0===t?void 0:t.textArea,e)},X=function(t,a){b.value!==t&&(void 0===e.value?b.value=t:y((function(){var e,t,a;w.value.textArea.value!==C.value&&(null===(e=w.value)||void 0===e||null===(t=(a=e.instance).update)||void 0===t||t.call(a))})),y((function(){a&&a()})))},Y=function(e){13===e.keyCode&&f("pressEnter",e),f("keydown",e)},q=function(t){var a=e.onBlur;null==a||a(t),h.onFieldBlur()},J=function(e){f("update:value",e.target.value),f("change",e),f("input",e),h.onFieldChange()},L=function(e){d(w.value.textArea,e,J),X("",(function(){O()}))},Q=function(t){var a=t.target.composing,n=t.target.value;if(_.value=!(!t.isComposing&&!a),!(_.value&&e.lazy||b.value===n)){if(H.value){var o=t.target;n=N(o.selectionStart>=e.maxlength+1||o.selectionStart===n.length||!o.selectionStart,C.value,n,e.maxlength)}d(t.currentTarget,t,J,n),X(n)}},U=function(){var t,a,l,i=u.style,r=u.class,s=e.bordered,v=void 0===s||s,c=o(o(o({},g(e,["allowClear"])),u),{},{style:R.value?{}:i,class:(t={},n(t,"".concat(P.value,"-borderless"),!v),n(t,"".concat(r),r&&!R.value),n(t,"".concat(P.value,"-sm"),"small"===V.value),n(t,"".concat(P.value,"-lg"),"large"===V.value),t),showCount:null,prefixCls:P.value,onInput:Q,onChange:Q,onBlur:q,onKeydown:Y,onCompositionstart:D,onCompositionend:G});return null!==(a=e.valueModifiers)&&void 0!==a&&a.lazy&&delete c.onInput,A(I,o(o({},c),{},{id:null!==(l=c.id)&&void 0!==l?l:h.id.value,ref:w,maxlength:e.maxlength}),null)};return s({focus:O,blur:function(){var e,t;null===(e=w.value)||void 0===e||null===(t=e.textArea)||void 0===t||t.blur()},resizableTextArea:w}),T((function(){var t=p(b.value);_.value||!H.value||null!==e.value&&void 0!==e.value||(t=M(t,e.maxlength)),C.value=t})),function(){var t=e.maxlength,l=e.bordered,s=void 0===l||l,c=e.hidden,d=u.style,p=u.class,f=o(o(o({},e),u),{},{prefixCls:P.value,inputType:"text",handleReset:L,direction:F.value,bordered:s,style:R.value?void 0:d}),g=A(v,o(o({},f),{},{value:C.value}),{element:U});if(R.value){var m=i(C.value).length,h="";h="object"===r(R.value)?R.value.formatter({count:m,maxlength:t}):"".concat(m).concat(H.value?" / ".concat(t):""),g=A("div",{hidden:c,class:a("".concat(P.value,"-textarea"),n({},"".concat(P.value,"-textarea-rtl"),"rtl"===F.value),"".concat(P.value,"-textarea-show-count"),p),style:d,"data-count":"object"!==r(h)?h:void 0},[g])}return g}}});export{H as T};
