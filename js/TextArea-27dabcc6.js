import{j as e,e as t,h as a,a as n,b as o,u as l,o as i,_ as r}from"./default-f04a21e2.js";import{t as u,a as s,C as v,b as c,r as d,f as p}from"./index-9f5a1c74.js";import{R as g}from"./index-99c1ec35.js";import{o as f,u as m}from"./FormItemContext-8a899d89.js";import{d as h,b as x,L as b,f as z,n as y,g as w,a as A,J as C,Q as S,e as E,G as T}from"./index-ef84d244.js";var j,V="\n min-height:0 !important;\n max-height:none !important;\n height:0 !important;\n visibility:hidden !important;\n overflow:hidden !important;\n position:absolute !important;\n z-index:-1000 !important;\n top:0 !important;\n right:0 !important\n",F=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break"],P={};function R(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&P[a])return P[a];var n=window.getComputedStyle(e),o=n.getPropertyValue("box-sizing")||n.getPropertyValue("-moz-box-sizing")||n.getPropertyValue("-webkit-box-sizing"),l=parseFloat(n.getPropertyValue("padding-bottom"))+parseFloat(n.getPropertyValue("padding-top")),i=parseFloat(n.getPropertyValue("border-bottom-width"))+parseFloat(n.getPropertyValue("border-top-width")),r=F.map((function(e){return"".concat(e,":").concat(n.getPropertyValue(e))})).join(";"),u={sizingStyle:r,paddingSize:l,borderSize:i,boxSizing:o};return t&&a&&(P[a]=u),u}const M=h({compatConfig:{MODE:3},name:"ResizableTextArea",inheritAttrs:!1,props:u(),setup:function(l,i){var r,u,v=i.attrs,c=i.emit,d=i.expose,p=x(),m=x({}),h=x(0);b((function(){e.cancel(r),e.cancel(u)}));var E=function(){var t=l.autoSize||l.autosize;if(t&&p.value){var a=t.minRows,n=t.maxRows;m.value=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;j||((j=document.createElement("textarea")).setAttribute("tab-index","-1"),j.setAttribute("aria-hidden","true"),document.body.appendChild(j)),e.getAttribute("wrap")?j.setAttribute("wrap",e.getAttribute("wrap")):j.removeAttribute("wrap");var o=R(e,t),l=o.paddingSize,i=o.borderSize,r=o.boxSizing,u=o.sizingStyle;j.setAttribute("style","".concat(u,";").concat(V)),j.value=e.value||e.placeholder||"";var s,v=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,d=j.scrollHeight;if("border-box"===r?d+=i:"content-box"===r&&(d-=l),null!==a||null!==n){j.value=" ";var p=j.scrollHeight-l;null!==a&&(v=p*a,"border-box"===r&&(v=v+l+i),d=Math.max(v,d)),null!==n&&(c=p*n,"border-box"===r&&(c=c+l+i),s=d>c?"":"hidden",d=Math.min(c,d))}return{height:"".concat(d,"px"),minHeight:"".concat(v,"px"),maxHeight:"".concat(c,"px"),overflowY:s,resize:"none"}}(p.value,!1,a,n),h.value=1,e.cancel(u),u=e((function(){h.value=2,u=e((function(){h.value=0,function(){try{if(document.activeElement===p.value){var e=p.value.selectionStart,t=p.value.selectionEnd;p.value.setSelectionRange(e,t)}}catch(a){}}()}))}))}},T=function(t){0===h.value&&(c("resize",t),(l.autoSize||l.autosize)&&(e.cancel(r),r=e(E)))};t(void 0===l.autosize,"Input.TextArea","autosize is deprecated, please use autoSize instead.");z((function(){return l.value}),(function(){y((function(){E()}))})),w((function(){y((function(){E()}))}));var F=S();return d({resizeTextarea:E,textArea:p,instance:F}),function(){return e=l.prefixCls,t=l.autoSize,i=l.autosize,r=l.disabled,u=f(l,["prefixCls","onPressEnter","autoSize","autosize","defaultValue","allowClear","type","lazy","maxlength","valueModifiers"]),c=a(e,v.class,n({},"".concat(e,"-disabled"),r)),d=[v.style,m.value,1===h.value?{overflowX:"hidden",overflowY:"hidden"}:null],(x=o(o(o({},u),v),{},{style:d,class:c})).autofocus||delete x.autofocus,0===x.rows&&delete x.rows,A(g,{onResize:T,disabled:!(t||i)},{default:function(){return[C(A("textarea",o(o({},x),{},{ref:p}),null),[[s]])]}});var e,t,i,r,u,c,d,x}}});function I(e,t){return i(e||"").slice(0,t).join("")}function N(e,t,a,n){var o=a;return e?o=I(a,n):i(t||"").length<a.length&&i(a||"").length>n&&(o=t),o}const _=h({compatConfig:{MODE:3},name:"ATextarea",inheritAttrs:!1,props:u(),setup:function(e,t){var u=t.attrs,s=t.expose,g=t.emit,h=m(),b=x(void 0===e.value?e.defaultValue:e.value),w=x(),C=x(""),j=l("input",e),V=j.prefixCls,F=j.size,P=j.direction,R=E((function(){return""===e.showCount||e.showCount||!1})),_=E((function(){return Number(e.maxlength)>0})),k=x(!1),H=x(),B=x(0),G=function(e){k.value=!0,H.value=C.value,B.value=e.currentTarget.selectionStart,g("compositionstart",e)},D=function(t){k.value=!1;var a,n=t.currentTarget.value;_.value&&(n=N(B.value>=e.maxlength+1||B.value===(null===(a=H.value)||void 0===a?void 0:a.length),H.value,n,e.maxlength));n!==C.value&&(Y(n),d(t.currentTarget,t,K,n)),g("compositionend",t)},O=S();z((function(){return e.value}),(function(){var t;O.vnode.props,b.value=null!==(t=e.value)&&void 0!==t?t:""}));var X=function(e){var t;c(null===(t=w.value)||void 0===t?void 0:t.textArea,e)},Y=function(t,a){b.value!==t&&(void 0===e.value?b.value=t:y((function(){var e,t,a;w.value.textArea.value!==C.value&&(null===(e=w.value)||void 0===e||null===(t=(a=e.instance).update)||void 0===t||t.call(a))})),y((function(){a&&a()})))},q=function(e){13===e.keyCode&&g("pressEnter",e),g("keydown",e)},J=function(t){var a=e.onBlur;null==a||a(t),h.onFieldBlur()},K=function(e){g("update:value",e.target.value),g("change",e),g("input",e),h.onFieldChange()},L=function(e){d(w.value.textArea,e,K),Y("",(function(){X()}))},Q=function(t){var a=t.target.composing,n=t.target.value;if(k.value=!(!t.isComposing&&!a),!(k.value&&e.lazy||b.value===n)){if(_.value){var o=t.target;n=N(o.selectionStart>=e.maxlength+1||o.selectionStart===n.length||!o.selectionStart,C.value,n,e.maxlength)}d(t.currentTarget,t,K,n),Y(n)}},U=function(){var t,a,l,i=u.style,r=u.class,s=e.bordered,v=void 0===s||s,c=o(o(o({},f(e,["allowClear"])),u),{},{style:R.value?{}:i,class:(t={},n(t,"".concat(V.value,"-borderless"),!v),n(t,"".concat(r),r&&!R.value),n(t,"".concat(V.value,"-sm"),"small"===F.value),n(t,"".concat(V.value,"-lg"),"large"===F.value),t),showCount:null,prefixCls:V.value,onInput:Q,onChange:Q,onBlur:J,onKeydown:q,onCompositionstart:G,onCompositionend:D});return null!==(a=e.valueModifiers)&&void 0!==a&&a.lazy&&delete c.onInput,A(M,o(o({},c),{},{id:null!==(l=c.id)&&void 0!==l?l:h.id.value,ref:w,maxlength:e.maxlength}),null)};return s({focus:X,blur:function(){var e,t;null===(e=w.value)||void 0===e||null===(t=e.textArea)||void 0===t||t.blur()},resizableTextArea:w}),T((function(){var t=p(b.value);k.value||!_.value||null!==e.value&&void 0!==e.value||(t=I(t,e.maxlength)),C.value=t})),function(){var t=e.maxlength,l=e.bordered,s=void 0===l||l,c=e.hidden,d=u.style,p=u.class,g=o(o(o({},e),u),{},{prefixCls:V.value,inputType:"text",handleReset:L,direction:P.value,bordered:s,style:R.value?void 0:d}),f=A(v,o(o({},g),{},{value:C.value}),{element:U});if(R.value){var m=i(C.value).length,h="";h="object"===r(R.value)?R.value.formatter({count:m,maxlength:t}):"".concat(m).concat(_.value?" / ".concat(t):""),f=A("div",{hidden:c,class:a("".concat(V.value,"-textarea"),n({},"".concat(V.value,"-textarea-rtl"),"rtl"===P.value),"".concat(V.value,"-textarea-show-count"),p),style:d,"data-count":"object"!==r(h)?h:void 0},[f])}return f}}});export{_ as T};
